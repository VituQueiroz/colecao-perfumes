<!DOCTYPE html>
<html lang="pt-br" data-bs-theme="dark">
<head>
<meta charset="UTF-8" />

<!-- üî• IMPORTANTE PARA CELULAR -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cole√ß√£o de Perfumes</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link rel="icon" type="image/png" href="https://icons.iconarchive.com/icons/iconarchive/mothers-day/48/Perfume-Bottle-icon.png">

<style>

/* ===== FUNDO OTIMIZADO PARA CELULAR ===== */
body { 
    font-family: "Poppins", sans-serif; 
    background: url("https://images.unsplash.com/photo-1485470733090-0aae1788d5af?fm=jpg&q=60&w=1500") no-repeat center center;
    background-size: cover; 
    background-attachment: scroll;
    backdrop-filter: blur(2px); 
    color:#fff;
}

/* ===== TEXTOS ===== */
h1,h2,h5,p,label { color:#fff; }

/* ===== CONTAINER GLASS ===== */
.glass-box { 
    background: rgba(0,0,0,0.35); 
    border: 1px solid rgba(255,255,255,0.15); 
    border-radius: 16px; 
    padding: 12px;
    box-shadow: 0 6px 25px rgba(0,0,0,0.5); 
    backdrop-filter: blur(10px); 
}

/* ===== FORM ===== */
.form-control { 
    border: 1px solid #666 !important; 
    background-color: rgba(0,0,0,0.3); 
    color: #fff; 
    font-size: 0.85rem;
    padding: 6px 10px;
}
.form-control:focus { 
    border-color: #aaa !important; 
    box-shadow: 0 0 0 0.2rem rgba(200,200,200,0.2); 
}

/* ===== ACCORDION ===== */
.accordion-button { 
    background: rgba(0,0,0,0.3) !important; 
    color: #fff !important; 
    border: none !important; 
    font-size: 0.85rem;
}
.accordion-body { 
    background: rgba(0,0,0,0.2); 
    border-radius: 10px; 
    padding: 8px 12px; 
    font-size: 0.75rem;
}

/* ===== CARDS ===== */
.card-wrap { perspective: 1000px; position: relative; }

.perfume-card { 
    background: rgba(0,0,0,0.25); 
    border: 1px solid rgba(255,255,255,0.2); 
    border-radius: 14px; 
    padding: 10px; 
    backdrop-filter: blur(6px); 
    cursor: pointer;
    transition: transform .25s ease, box-shadow .3s ease, background .3s ease; 
    transform-origin: center;
    position: relative; 
    font-size: 0.8rem;
}

@media (hover:hover) {
    .perfume-card:hover { 
        transform: translateY(-4px); 
        box-shadow: 0 10px 35px rgba(0,0,0,0.65); 
    }
}

.perfume-img { 
    width: 80px; 
    height: 80px; 
    object-fit: cover; 
    border-radius: 12px; 
    border: 2px solid #fff; 
    transition: transform .3s ease; 
}

@media (hover:hover) {
    .perfume-card:hover .perfume-img { transform: scale(1.05); }
}

/* ===== FAVORITO ===== */
.favorite { 
    position: absolute; 
    top: 8px; right: 8px; 
    font-size: 1.4rem; 
    cursor: pointer; 
    z-index: 2;
}
.favorite:hover { transform: scale(1.15); }
.favorite i.far { color: white; }
.favorite i.fas { color: red; }
.favorite:not(.favorito) i.far:hover { color: red !important; }

/* ===== EXPANDIR ===== */
.collapse-content { display: none; margin-top: 6px; }
.collapse-content.show { display: block; }

/* ===== BOT√ïES ===== */
.button-row {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 10px;
}
.button-row .btn {
    flex: 1 1 calc(50% - 6px);
    white-space: nowrap;
}

/* BADGES */
.badge-oc, .badge-nota {
    margin-right: 3px;
    margin-bottom: 3px;
    padding: 4px 8px;
    border-radius: 5px;
    font-size: 0.65rem;
}
.badge-cat {
    background: #adb5bd !important;
    color: #000 !important;
    font-size: 0.7rem;
}

/* CORES */
.bg-brown { background:#8d6e63 !important; color:white !important; }
.bg-yellow { background:#f7d700 !important; color:black !important; }
.bg-pink { background:#ff4fa3 !important; color:white !important; }
.bg-skyblue { background:#5bc0de !important; color:black !important; }
.bg-red { background:#dc3545 !important; }
.bg-orange { background:#fd7e14 !important; }
.bg-cyan { background:#0dcaf0 !important; color:black !important; }
.bg-green { background:#198754 !important; }
.bg-purple { background:#6f42c1 !important; }
.bg-darkgreen { background:#14532d !important; }

/* ===== ESTRELAS ===== */
.star { cursor: pointer; font-size: 1rem; }
.star.fas { color: #ffc107 !important; }
.star.far { color: #6c757d !important; }

@media (hover:hover) {
    .star:hover { transform: scale(1.15); transition: 0.2s; }
}
</style>
</head>

<body>
<div id="app">

<nav class="navbar navbar-dark bg-dark mb-3 rounded shadow p-2">
  <div class="container-fluid">
    <a class="navbar-brand" href="#" @click="tela='grid'">
      <i class="fa fa-th"></i> Lista
    </a>
    <a class="navbar-brand" href="#" @click="tela='cadastro'">
      <i class="fa fa-plus"></i> Cadastro
    </a>
  </div>
</nav>

<div id="app" class="container py-3">

<header class="text-center mb-3">
    <h1 style="font-size:1.6rem;">Minha Cole√ß√£o de Perfumes</h1>
</header>

<div class="row g-3">

<!-- ========================= -->
<!--   FORMUL√ÅRIO CENTRALIZADO -->
<!-- ========================= -->
<div v-if="tela==='cadastro'" class="d-flex justify-content-center w-100">
  <div class="col-12 col-md-3">
    <div class="glass-box">

      <h2 style="font-size:1.1rem;">{{ editIndex !== null ? "Editar Perfume" : "Cadastrar Perfume" }}</h2>

      <input class="form-control mt-2" placeholder="Nome" v-model="nome">
      <input class="form-control mt-2" placeholder="Marca" v-model="marca">
      <input class="form-control mt-2" placeholder="Site fabricante" v-model="site">
      <input class="form-control mt-2" placeholder="URL da imagem" v-model="imagem">
      <img v-if="imagem" :src="imagem" class="img-fluid mt-2 rounded shadow" style="max-height:90px;">

      <input class="form-control mt-2" type="number" placeholder="Volume (ml)" v-model="volume">
      <input class="form-control mt-2" type="number" placeholder="Ano" v-model="ano">
      <input class="form-control mt-2" type="number" placeholder="Pre√ßo (R$)" v-model="preco">

      <!-- ACCORDIONS -->
      <div class="accordion mt-3" id="accordionForm">

<div class="accordion-item bg-transparent">
  <h2 class="accordion-header">
    <button class="accordion-button" type="button" @click="toggleAba('oc')">
      Ocasi√µes
    </button>
  </h2>

  <div :class="'accordion-collapse collapse ' + (abasAbertas.oc ? 'show' : '')">
    <div class="accordion-body">
      
      <div v-for="oc in opcoesOcasi√µes" :key="oc" class="form-check">
        <input 
          class="form-check-input"
          type="checkbox"
          :id="'oc-' + oc"
          :value="oc"
          v-model="ocasi√µes"
        >
        <label class="form-check-label" :for="'oc-' + oc">
          {{ oc }}
        </label>
      </div>

    </div>
  </div>
</div>


        <div class="accordion-item bg-transparent mt-2">
          <h2 class="accordion-header">
            <button class="accordion-button" type="button" @click="toggleAba('pref')">Prefer√™ncias</button>
          </h2>
          <div :class="'accordion-collapse collapse ' + (abasAbertas.pref ? 'show':'' )">
            <div class="accordion-body">
              <select class="form-control mt-1" v-model="tempo">
                <option disabled value="">Dia ou Noite?</option>
                <option>Dia</option>
                <option>Noite</option>
              </select>
              <select class="form-control mt-1" v-model="estacao">
                <option disabled value="">Frio ou Calor?</option>
                <option>Frio</option>
                <option>Calor</option>
              </select>
            </div>
          </div>
        </div>

<div class="accordion-item bg-transparent mt-2">
  <h2 class="accordion-header">
    <button class="accordion-button" type="button" @click="toggleAba('notas')">
      Notas Olfativas
    </button>
  </h2>

  <div :class="'accordion-collapse collapse ' + (abasAbertas.notas ? 'show' : '')">
    <div class="accordion-body">
      
      <div v-for="nota in opcoesNotasAromaticas" :key="nota" class="form-check">
        <input 
          class="form-check-input"
          type="checkbox"
          :id="'nota-' + nota"
          :value="nota"
          v-model="notasSelecionadas"
        >
        <label class="form-check-label" :for="'nota-' + nota">
          {{ nota }}
        </label>
      </div>

    </div>
  </div>
</div>


      </div>

      <h5 class="mt-3">Categoria</h5>
      <input class="form-control" v-model="categoria">

      <button class="btn btn-primary w-100 mt-3" :disabled="!podeSalvar" @click="cadastrarPerfume">
        {{ editIndex !== null ? "Salvar Altera√ß√µes" : "Cadastrar Perfume" }}
      </button>

      <button class="btn btn-secondary w-100 mt-2" v-if="editIndex !== null" @click="cancelarEdicao">
        Cancelar
      </button>

      <button class="btn btn-success w-100 mt-2" @click="exportarJSON">
        Exportar Cole√ß√£o
      </button>

      <input type="file" id="importarArquivo" style="display:none" @change="importarJSON">

      <button class="btn btn-warning w-100 mt-2" @click="abrirImportacao">
        Importar Cole√ß√£o
      </button>

    </div>
  </div>
</div>

<!-- ============================= -->
<!--     GRID CENTRALIZADO        -->
<!-- ============================= -->
<div v-if="tela==='grid'" class="d-flex justify-content-center w-100">
<div class="col-12 col-md-9">
  <div class="glass-box">

    <div class="d-flex gap-2 mb-2 align-items-center">
      <input class="form-control" placeholder="Buscar..." v-model="filtroGeral" style="font-size:0.85rem;">

      <select class="form-control w-auto" v-model="sortBy" style="font-size:0.85rem;">
        <option value="none">Ordenar</option>
        <option value="nome_az">Nome (A ‚Üí Z)</option>
        <option value="nome_za">Nome (Z ‚Üí A)</option>
        <option value="preco_cresc">Menor Pre√ßo</option>
        <option value="preco_desc">Maior Pre√ßo</option>
        <option value="nota_cresc">Menor Nota</option>
        <option value="nota_desc">Maior Nota</option>
      </select>

      <label class="form-check-label ms-2" style="color:#fff;">
        <input class="form-check-input" type="checkbox" v-model="somenteFavoritos">
        Favoritos
      </label>
    </div>

    <div class="mb-2" style="font-size:0.8rem;">
      <strong>Total:</strong> {{ listaFiltrada.length }} |
      <strong>Valor:</strong> {{ valorTotal | reais }}
    </div>

    <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-3 justify-content-center">

      <div class="col" v-for="(perfume,index) in listaFiltradaSorted" :key="index">
        <div class="card-wrap">
          <div class="perfume-card" @click="toggleExpand(perfume)">

            <div v-if="!perfume.expandido" class="favorite" @click.stop="toggleFavorito(perfume)">
              <i :class="perfume.favorito ? 'fas fa-heart':'far fa-heart'"></i>
            </div>

            <div v-if="!perfume.expandido" class="text-center">
              <img :src="perfume.imagem" class="perfume-img mb-2">
              <h5>{{ perfume.nome }}</h5>
              <p class="mb-1"><strong>{{ perfume.preco | reais }}</strong></p>
              <p class="mb-0">
                <span v-for="n in 5" :key="n"
                  class="fa-star star"
                  :class="{'fas': n <= perfume.nota, 'far': n > perfume.nota}"
                  @click.stop="setNotaPerfume(perfume,n)">
                </span>
              </p>
            </div>

            <div class="collapse-content" :class="{'show': perfume.expandido}">
              <a v-if="perfume.site" :href="perfume.site" target="_blank" class="btn btn-success btn-sm position-absolute top-0 end-0 mt-1 me-1" title="Comprar">
                  <i class="fas fa-shopping-cart"></i>
                </a>

              <p><strong>Marca:</strong> {{ perfume.marca }}</p>
              <p><strong>Volume:</strong> {{ perfume.volume }} ml</p>
              <p><strong>Ano:</strong> {{ perfume.ano }}</p>
              <p><strong>Dia/Noite:</strong> {{ perfume.tempo }}</p>
              <p><strong>Esta√ß√£o:</strong> {{ perfume.estacao }}</p>

              <p><strong>Ocasi√µes:</strong><br>
                <span v-for="oc in perfume.ocasi√µes" :key="oc"
                      class="badge badge-oc" :class="'bg-' + badgeColorOc(oc)">
                {{ oc }}</span>
              </p>

              <p><strong>Notas:</strong><br>
                <span v-for="nota in perfume.notasSelecionadas" :key="nota"
                      class="badge badge-nota" :class="'bg-' + badgeColorNota(nota)">
                {{ nota }}</span>
              </p>

              <p><strong>Categoria:</strong><br>
                <span class="badge badge-cat">{{ perfume.categoria }}</span>
              </p>
            </div>

            <div class="button-row">
              <button class="btn btn-info btn-sm" @click.stop="duplicar(perfume)">Duplicar</button>
              <button class="btn btn-danger btn-sm" @click.stop="excluir(perfume)">Excluir</button>
              <button class="btn btn-success btn-sm" @click.stop="alterar(perfume)">Editar</button>
            </div>

          </div>
        </div>
      </div>

    </div>
  </div>
</div>
</div>

</div> <!-- row -->
</div> <!-- container -->

<script>
new Vue({
  el:"#app",
  data:{
    somenteFavoritos:false,
    nome:'', marca:'', imagem:'', volume:'', ano:'', preco:'',
    ocasi√µes:[], tempo:'', estacao:'', notasSelecionadas:[],
    categoria:'', site:'', filtroGeral:'',
    opcoesOcasi√µes:["Dia a Dia","Profissional","Balada","Encontro","Faculdade","Academia","Casamento","Happy Hour"],
    opcoesNotasAromaticas:["Amadeirado","C√≠trico","Doce","Fresco","Oriental","Especiado","Aqu√°tico / Marinho","Arom√°tico","Frutado","Herbal"],
    listaPerfumes:[],
    abasAbertas:{ oc:false, pref:false, notas:false },
    editIndex:null,
    tela: 'grid',
    notaTemp:0,
    sortBy:'none'
  },
  mounted(){
    const save = localStorage.getItem("perfumes");
    if(save) this.listaPerfumes = JSON.parse(save);
  },
  watch:{
    listaPerfumes:{ deep:true, handler(v){ localStorage.setItem("perfumes", JSON.stringify(v)); } }
  },
  computed:{
    valorTotal(){ return this.listaFiltrada.reduce((t,p)=>t+parseFloat(p.preco||0),0); },
    listaFiltrada(){
      return this.listaPerfumes.filter(p=>{
        const f=p.nome.toLowerCase().includes(this.filtroGeral.toLowerCase());
        const m=p.marca && p.marca.toLowerCase().includes(this.filtroGeral.toLowerCase());
        return (f||m) && (this.somenteFavoritos? p.favorito:true);
      });
    },
    listaFiltradaSorted(){
      const arr=this.listaFiltrada.slice();
      switch(this.sortBy){
        case 'nome_az': arr.sort((a,b)=>a.nome.localeCompare(b.nome,'pt-BR')); break;
        case 'nome_za': arr.sort((a,b)=>b.nome.localeCompare(a.nome,'pt-BR')); break;
        case 'preco_cresc': arr.sort((a,b)=>a.preco-b.preco); break;
        case 'preco_desc': arr.sort((a,b)=>b.preco-a.preco); break;
        case 'nota_cresc': arr.sort((a,b)=>a.nota-b.nota); break;
        case 'nota_desc': arr.sort((a,b)=>b.nota-a.nota); break;
      }
      return arr;
    },
    podeSalvar(){
      return this.nome && this.marca && this.imagem && this.volume &&
             this.ano && this.preco && this.ocasi√µes.length &&
             this.notasSelecionadas.length && this.tempo &&
             this.estacao && this.categoria && this.site;
    }
  },
  filters:{
    reais(v){ return "R$ "+parseFloat(v).toFixed(2).replace(".",","); }
  },
  methods:{
  
    toggleAba(a){ this.abasAbertas[a]=!this.abasAbertas[a]; },

cadastrarPerfume() {
  let fav = false;

  if (this.editIndex !== null)
    fav = this.listaPerfumes[this.editIndex].favorito;

  const perfume = {
    nome: this.nome,
    marca: this.marca,
    imagem: this.imagem,
    volume: this.volume,
    ano: this.ano,
    preco: this.preco,
    ocasi√µes: [...this.ocasi√µes],
    tempo: this.tempo,
    estacao: this.estacao,
    notasSelecionadas: [...this.notasSelecionadas],
    categoria: this.categoria,
    site: this.site,
    expandido: false,
    nota: this.editIndex !== null ? this.notaTemp : 0,
    favorito: fav
  };

  if (this.editIndex !== null)
    Vue.set(this.listaPerfumes, this.editIndex, perfume);
  else
    this.listaPerfumes.push(perfume);

  this.resetar();
  this.tela = 'grid';
},

abrirImportacao() {
  document.getElementById("importarArquivo").click();
},

alterar(perfume) {
  const indexReal = this.listaPerfumes.indexOf(perfume);

  const p = this.listaPerfumes[indexReal];

  this.tela = 'cadastro';
  this.nome = p.nome;
  this.marca = p.marca;
  this.imagem = p.imagem;
  this.volume = p.volume;
  this.ano = p.ano;
  this.preco = p.preco;
  this.ocasi√µes = [...p.ocasi√µes];
  this.tempo = p.tempo;
  this.estacao = p.estacao;
  this.notasSelecionadas = [...p.notasSelecionadas];
  this.categoria = p.categoria;
  this.site = p.site;

  this.notaTemp = p.nota;
  this.editIndex = indexReal;
},

duplicar(perfume) {
  const indexReal = this.listaPerfumes.indexOf(perfume);

  const clone = JSON.parse(JSON.stringify(this.listaPerfumes[indexReal]));
  clone.expandido = false;
  clone.favorito = false;

  this.listaPerfumes.push(clone);

  this.alterar(clone);
},

cancelarEdicao(){
   this.resetar(); 
   this.tela = 'grid';
},

resetar(){
  this.nome=this.marca=this.imagem=this.volume=this.ano=this.preco='';
  this.ocasi√µes=[]; 
  this.tempo=''; 
  this.estacao='';
  this.notasSelecionadas=[]; 
  this.categoria=''; 
  this.site='';
  this.editIndex=null; 
  this.notaTemp=0;
  this.abasAbertas={oc:false,pref:false,notas:false};
},

excluir(perfume) {
  if (!confirm("Tem certeza que deseja excluir este perfume?")) return;

  const indexReal = this.listaPerfumes.indexOf(perfume);
  this.listaPerfumes.splice(indexReal, 1);
},

toggleExpand(p){
  const aberto=p.expandido;
  this.listaPerfumes.forEach(x=>x.expandido=false);
  p.expandido=!aberto;
},

setNotaPerfume(perfume, n) {
  const indexReal = this.listaPerfumes.indexOf(perfume);
  if (indexReal !== -1) {
    this.listaPerfumes[indexReal].nota = n;
    this.notaTemp = n;
  }
},


toggleFavorito(p){ p.favorito=!p.favorito; },

badgeColorOc(o){
  return {
    "Dia a Dia":"primary","Profissional":"dark","Balada":"purple",
    "Encontro":"red","Faculdade":"green","Academia":"orange",
    "Casamento":"yellow","Happy Hour":"cyan"
  }[o] || "secondary";
},

exportarJSON() {

  if (!confirm("Deseja realmente exportar toda a cole√ß√£o de perfumes?")) {
    return;
  }

  const data = JSON.stringify(this.listaPerfumes, null, 2);
  const blob = new Blob([data], { type: "application/json" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "colecao_perfumes.json";
  a.click();

  URL.revokeObjectURL(url);

  alert("Cole√ß√£o exportada com sucesso!");
},


importarJSON(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (e) => {
    try {
      const novaLista = JSON.parse(e.target.result);

      if (!Array.isArray(novaLista)) {
        alert("Arquivo inv√°lido!");
        return;
      }

      this.listaPerfumes.push(...novaLista);
      alert("Perfumes importados com sucesso!");

    } catch (erro) {
      alert("Erro ao importar arquivo JSON.");
    }
  };

  reader.readAsText(file);
},

badgeColorNota(n){
  return{
    "Amadeirado":"brown","C√≠trico":"yellow","Doce":"pink",
    "Fresco":"skyblue","Oriental":"red","Especiado":"orange",
    "Aqu√°tico / Marinho":"cyan","Arom√°tico":"green",
    "Frutado":"purple","Herbal":"darkgreen"
  }[n] || "secondary";
}

  }
});
</script>

</body>
</html>
